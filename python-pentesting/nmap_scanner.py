# Nmap Scanner in Python.

# Importing the nmap module.
import nmap

# Initializing the port scanner.
scanner = nmap.PortScanner()

# Initial message.
print(" ")
print("Welcome. This is an Nmap automation tool.")
print("-----------------------------------------")

# Prompting the user to enter an IP address.
ip_addr = input("Please, enter an IP address to scan: ")
print("The IP address you entered is:", ip_addr)
type(ip_addr)

# Asking what type of scan to run.
resp = input("""\nPlease, choose the type of scan you want to run
  1) SYN ACK scan.
  2) UDP scan.
  3) Comprehensive scan.
Select an option (number): """)
print(" ")

# Executing the corresponding scan.
if resp == '1':
  print("SYN ACK scan.")
  print("Nmap Version:", scanner.nmap_version())
  scanner.scan(ip_addr, '1-1024', '-v -sS')
  print("Scan info:", scanner.scaninfo())
  print("IP status:", scanner[ip_addr].state())
  print("Protocols:", scanner[ip_addr].all_protocols())
  print("Open ports:", scanner[ip_addr]['tcp'].keys())
elif resp == '2':
  print("UDP scan.")
  print("Nmap Version:", scanner.nmap_version())
  scanner.scan(ip_addr, '1-1024', '-v -sU')
  print("Scan info:", scanner.scaninfo())
  print("IP status:", scanner[ip_addr].state())
  print("Protocols:", scanner[ip_addr].all_protocols())
  print("Open ports:", scanner[ip_addr]['udp'].keys())
elif resp == '3':
  print("Comprehensive scan.")
  print("Nmap Version:", scanner.nmap_version())
  scanner.scan(ip_addr, '1-1024', '-v -sS -sV -sC -A -O')
  print("Scan info:", scanner.scaninfo())
  print("IP status:", scanner[ip_addr].state())
  print("Protocols:", scanner[ip_addr].all_protocols())
  print("Open ports:", scanner[ip_addr]['tcp'].keys())
elif resp >= '4' or resp == '0':
  print("Invalid option.")