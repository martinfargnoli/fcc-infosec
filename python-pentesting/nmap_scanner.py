# Nmap Scanner in Python.

# Importing the nmap module.
import nmap

# Auxiliary dictionary for the Nmap scanner.
resp_dict = {
  '1': ['-v -sS', 'tcp'],
  '2': ['-v -sU', 'udp'],
  '3': ['-v -sS -sV -sC -A -O', 'tcp']
}

# Nmap scanner function.
def nmapScanner(ip_addr, resp):
  # Initializing the Nmap port scanner.
  scanner = nmap.PortScanner()

  # Running the scanner.
  if resp not in resp_dict.keys():
    print("ERROR: Invalid option.")
  else:
    print("Nmap Version:", scanner.nmap_version())
    scanner.scan(ip_addr, "1-1024", resp_dict[resp][0])
    print("Scan info:", scanner.scaninfo())
    if scanner.scaninfo() == 'up':
      print("Scanner status:", scanner[ip_addr].state())
      print("Protocols:", scanner[ip_addr].all_protocols())
      print("Open ports:", scanner[ip_addr][resp_dict[resp][1]].keys())

# Main function.
def main():
  # Initial message.
  print(" ")
  print("Welcome. This is an Nmap automation tool.")
  print("-----------------------------------------")

  # Prompting the user to enter an IP address.
  ip_addr = input("Please, enter an IP address to scan: ")
  print("The IP address you entered is:", ip_addr)
  type(ip_addr)

  # Asking what type of scan to run and executing the scanner function.
  resp = input("""\nPlease, choose the type of scan you want to run
    1) SYN ACK scan.
    2) UDP scan.
    3) Comprehensive scan.
  Select an option (number): """)
  print(" ")
  nmapScanner(ip_addr, resp)